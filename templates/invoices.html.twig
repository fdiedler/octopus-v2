{% extends 'base.html.twig' %}

{% block content %}
<div class="table-responsive">
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th>Reference</th>
                <th>Market</th>
                <th>Property / Host</th>
                <th>Amount without taxes (taxes)</th>
                <th>Details</th>
                <th>Done</th>
            </tr>
        </thead>
        <tbody>
            {% for i in invoices %}
                {% set backColor="" %}
                
                {% if (i.done) %}
                    {% set backColor="#99ff99" %}
                {% endif %}
                
                <tr style="background-color:{{ backColor }}">
                    <td>{{ i.reference }}</td>
                    <td>{{ i.property.market }}</td>
                    <td>{{ i.property.label }}<br/>{{ i.property.host.name }}<br/>({{ i.property.host.wehostEmailAlias }})</td>
                    <td>{{ i.amountWithoutTaxes|formatMoney }} ({{ i.taxesAmount|formatMoney }})</td>
                    <td>
                        {% for detail in i.details %}
                            {% set str = detail[0] %}
                            {% if ('pas de donn√©es' in str) %}
                                <span style='color:red'>{{ detail[0] }} - {{ detail[1] }}</span><br/>
                            {% else %}
                                {{ detail[0] }} - {{ detail[1] }}<br/>
                            {% endif %}
                            
                        {% endfor %}
                    </td>
                    <td>
                        {% if (i.done) %}
                            <a class="linkDefault" href="{{ url('export_invoices', { 'yearMonth': app.request.get('yearMonth'), 'marketId': app.request.get('marketId'), 'invoiceRef' : i.reference, 'action': "0" }) }}">Reset</a>
                        {% else %}
                            <a class="linkDefault" href="{{ url('export_invoices', { 'yearMonth': app.request.get('yearMonth'), 'marketId': app.request.get('marketId'), 'invoiceRef' : i.reference }) }}">Imported in Times</a>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
